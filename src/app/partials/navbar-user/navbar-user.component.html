<div class="navbar-sidebar-wrapper">
  <!-- Desktop sidebar -->
  <nav class="scoop-side-navbar" *ngIf="!isMobileView">
    <ul class="scoop-navbar-list">

      <!--Registro con Dropdown-->
      <li *ngIf="canSeeStudentItems()" class="scoop-navbar-item scoop-navbar-dropdown"
          (click)="toggleMenu('registro')" [class.active]="expandedMenu === 'registro'">
        <span class="material-icons">person_add</span>
        <span>Registro</span>
        <span class="material-icons dropdown-icon">{{ expandedMenu === 'registro' ? 'expand_less' : 'expand_more' }}</span>
      </li>

      <!-- Submenú de Registro -->
      <ul class="scoop-submenu-list" *ngIf="expandedMenu === 'registro'">

        <!-- Solo un Admin puede registrar admin-->
        <li *ngIf="isAdmin()" routerLink="/registro-usuarios/administrador" routerLinkActive="active" class="scoop-submenu-item">
          <span class="material-icons">admin_panel_settings</span>
          <span>Admin</span>
        </li>

        <!-- Solo maestro y admin pueden registrar un maestro-->
        <li *ngIf="canSeeTeacherItems()" routerLink="/registro-usuarios/maestro" routerLinkActive="active" class="scoop-submenu-item">
          <span class="material-icons">person</span>
          <span>Maestro</span>
        </li>

        <!-- Admin, maestro y alumno pueden registrar alumno-->
        <li *ngIf="canSeeStudentItems()" routerLink="/registro-usuarios/alumno" routerLinkActive="active" class="scoop-submenu-item">
          <span class="material-icons">school</span>
          <span>Alumno</span>
        </li>

        <!-- Solo admin puede registrar un evento-->
        <li *ngIf="isAdmin()" routerLink="/registro-eventos-academicos" routerLinkActive="active" class="scoop-submenu-item">
          <span class="material-icons">event_available</span>
          <span>Evento</span>
        </li>
      </ul>

      <!-- Admins -->
      <li *ngIf="canSeeAdminItems()" routerLink="/administrador" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">admin_panel_settings</span>
        <span>Admins</span>
      </li>

      <!-- Maestros -->
     <li *ngIf="canSeeTeacherItems()" routerLink="/maestros" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">people</span>
        <span>Maestros</span>
      </li>

      <!-- Alumnos -->
      <li *ngIf="canSeeStudentItems()" routerLink="/alumnos" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">school</span>
        <span>Alumnos</span>
      </li>

      <!-- Gráficas -->
      <li *ngIf="canSeeStudentItems()" routerLink="/graficas" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">bar_chart</span>
        <span>Gráficas</span>
      </li>

      <!-- Eventos Académicos-->
      <li *ngIf="canSeeStudentItems()" routerLink="/eventos-academicos" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">event</span>
        <span>Eventos Académicos</span>
      </li>

    </ul>
    <button class="scoop-logout-btn" (click)="logout()">
      <span class="material-icons">logout</span>
      <span>Cerrar sesión</span>
    </button>
  </nav>

  <!-- Scoop-style top navbar -->
  <nav class="scoop-navbar">
    <button class="dashboard-toggle-btn" *ngIf="isMobileView" (click)="toggleSidebar()" aria-label="Abrir menú">
      <span class="material-icons">menu_open</span>
    </button>
    <span class="scoop-navbar-logo">BUAP</span>
    <div class="scoop-navbar-icons">
      <span class="material-icons navbar-icon" (click)="togglePalette()" style="cursor:pointer">palette</span>
      <div class="scoop-navbar-avatar" *ngIf="userInitial">{{ userInitial }}</div>
    </div>
  </nav>

  <!-- Mobile sidebar overlay and menu -->
  <ng-container *ngIf="isMobileView">
    <div class="mobile-sidebar-overlay" [class.mobile-open]="mobileOpen" (click)="closeSidebar()"></div>
    <nav class="scoop-side-navbar" [class.mobile-open]="mobileOpen">
      <ul class="scoop-navbar-list">

        <!-- Registro móvil con Dropdown -->
        <li *ngIf="canSeeStudentItems()" class="scoop-navbar-item scoop-navbar-dropdown"
            (click)="toggleMenu('registro')" [class.active]="expandedMenu === 'registro'">
          <span class="material-icons">person_add</span>
          <span>Registro</span>
          <span class="material-icons dropdown-icon">{{ expandedMenu === 'registro' ? 'expand_less' : 'expand_more' }}</span>
        </li>

        <ul class="scoop-submenu-list" *ngIf="expandedMenu === 'registro'">
          <li *ngIf="isAdmin()" routerLink="/registro-usuarios/administrador" routerLinkActive="active" class="scoop-submenu-item" (click)="closeSidebar()">
            <span class="material-icons">admin_panel_settings</span>
            <span>Admin</span>
          </li>
          <li *ngIf="canSeeTeacherItems()" routerLink="/registro-usuarios/maestro" routerLinkActive="active" class="scoop-submenu-item" (click)="closeSidebar()">
            <span class="material-icons">person</span>
            <span>Maestro</span>
          </li>
          <li *ngIf="canSeeStudentItems()" routerLink="/registro-usuarios/alumno" routerLinkActive="active" class="scoop-submenu-item" (click)="closeSidebar()">
            <span class="material-icons">school</span>
            <span>Alumno</span>
          </li>
          <li *ngIf="isAdmin()" routerLink="/registro-eventos-academicos" routerLinkActive="active" class="scoop-submenu-item" (click)="closeSidebar()">
            <span class="material-icons">event_available</span>
            <span>Evento</span>
          </li>
        </ul>

        <!-- Resto del menú móvil -->
        <li *ngIf="canSeeAdminItems()" routerLink="/administrador" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">admin_panel_settings</span>
          <span>Admins</span>
        </li>
        <li *ngIf="canSeeTeacherItems()" routerLink="/maestros" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">people</span>
          <span>Maestros</span>
        </li>
        <li *ngIf="canSeeStudentItems()" routerLink="/alumnos" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">school</span>
          <span>Alumnos</span>
        </li>
        <li *ngIf="canSeeStudentItems()" routerLink="/graficas" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">bar_chart</span>
          <span>Gráficas</span>
        </li>
        <li *ngIf="canSeeStudentItems()" routerLink="/eventos-academicos" routerLinkActive="active" class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">event</span>
          <span>Eventos Académicos</span>
        </li>
      </ul>
      <button class="scoop-logout-btn" (click)="logout(); closeSidebar()">
        <span class="material-icons">logout</span>
        <span>Cerrar sesión</span>
      </button>
    </nav>
  </ng-container>
</div>
